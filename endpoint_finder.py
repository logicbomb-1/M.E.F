import nmap
import json
import requests
import subprocess
import argparse
import warnings

warnings.filterwarnings("ignore", message="Unverified HTTPS request")


def port_scan(file_path):
    str = list()
    nm = nmap.PortScanner()
    file1 = open(file_path, "r")
    print("Scanning Port. Please wait.")
    Lines = file1.readlines()
    for line in Lines:
        str.append(line)
        str.append("-->")
        host = line.strip()
        res = nm.scan(
            hosts=host,
            arguments="-p21,22,23,25,3301,9001,9200,9201,5601,5602,5600,5601,9300,9301,9600,9601,8080,8090,27017,27018,27019,6379,16379,26379,6380,2375,2376,2374,3389,5500,6666,28015,6501,4369,6984,5050,5000,29015,9042,7199, --open",
        )
        res = res["scan"]
        for key in res:
            ip = key
            ports = res[ip]["tcp"].keys()
            for port in ports:
                str.append(port)
                str.append(": ")
                str.append(res[ip]["tcp"][port]["name"])
    print(str)

def subdomain_finder(file_path):
    print("Finding Subdomain. Please wait.")
    open("domains.txt", "w").close()
    command1 = "subfinder -silent -dL" + " " + file_path + " " + "-o domains.txt"
    process = subprocess.Popen(
        command1, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True
    )
    out, err = process.communicate()
    if err.decode() != "":
        print(err.decode())

def endpoint_check(file_path):
    print("Finding exposed endpoint. Please wait.")
    rep = list()
    endpoints = [
        "/info",
        "/auditevents",
        "/health",
        "/metrics",
        "/loggers",
        "/httptrace",
        "/env",
        "/flyway",
        "/liquidbase",
        "/mappings",
        "/scheduledtasks",
        "/logfile",
        "/heapdump",
        "/threaddump",
        "/features",
        "/.git/HEAD",
        "/beans",
        "/routes",
        "/.git/HEAD",
        "/.git/index",
        "/.git/config",
        "/.gitignore",
        "/.git-credentials",
        "/composer.lock",
        "/.svn/wc.db",
        "/.svnignore",
        "/CVS/Entries",
        "/.cvsignore",
        "/.idea/misc.xml",
        "/.idea/workspace.xml",
        "/.DS_Store",
        "/.svn/all-wcprops",
        "/.svn/entries",
        "/.bzr/README",
        "/.hg/store/fncache",
        "/.bzr/checkout/dirstate",
        "/config/",
        "/api/v1/nodes",
    ]
    endpoints1 = [
        "/info",
        "/auditevents",
        "/health",
        "/metrics",
        "/loggers",
        "/httptrace",
        "/env",
        "/flyway",
        "/liquidbase",
        "/mappings",
        "/scheduledtasks",
        "/logfile",
        "/heapdump",
        "/threaddump",
        "/features",
        "/.git/HEAD",
        "/beans",
        "/routes",
        "/.git/HEAD",
        "/.git/index",
        "/.git/config",
        "/.gitignore",
        "/.git-credentials",
        "/composer.lock",
        "/.svn/wc.db",
        "/.svnignore",
        "/CVS/Entries",
        "/.cvsignore",
        "/.idea/misc.xml",
        "/.idea/workspace.xml",
        "/.DS_Store",
        "/.svn/all-wcprops",
        "/.svn/entries",
        "/.bzr/README",
        "/.hg/store/fncache",
        "/.bzr/checkout/dirstate",
        "/admin/",
        "/admin.asp/",
        "/admin/admin.asp/",
        "/admin.aspx/",
        "/admin/admin.aspx/",
        "/admin.php/",
        "/administrator/",
        "/login.php",
        "/admin.php",
        "/user/",
        "/usuarios/",
        "/usuario/",
        "/Admin/",
        "/cpanel/",
        "/phpmyadmin/",
        "/dashboard",
        "/cms/",
        "/users/",
        "/wp-login.php/",
        "/admin/login",
        "/auth/login/",
        "/moderator/",
        "/webadmin/",
        "/webmaster/",
        "/adminarea/",
        "/bb-admin/",
        "/wp-admin/",
        "/wp-login/",
        "/wp-admin.php",
        "/userlogin/",
        "/logins/",
        "/login.html",
        "/adminLogin/",
        "/admin_area/",
        "/panel-administracion/",
        "/instadmin/",
        "/memberadmin/",
        "/administratorlogin/",
        "/panel/",
        "/forum/admin",
        "/adm/",
        "/cp/",
        "/vue-element-admin",
        "/admin/cp.php",
        "/cp.php",
        "/downloads/",
        "/data/",
        "/admincontrol/",
        "/admin/backup/",
        "/admincp/",
        "/admin/account.php",
        "/admin/index.php",
        "/admin/login.php",
        "/admin/admin.php",
        "/admin_area/admin.php",
        "/admin_area/login.php",
        "/siteadmin/login.php",
        "/siteadmin/index.php",
        "/siteadmin/login.html",
        "/admin/account.html",
        "/admin/index.html",
        "/admin/login.html",
        "/admin/admin.html",
        "/admin_area/index.php",
        "/dashboard.html",
        "/dashboard.php",
        "/bb-admin/index.php",
        "/bb-admin/login.php",
        "/bb-admin/admin.php",
        "/admin/home.php",
        "/admin_area/login.html",
        "/admin_area/index.html",
        "/admin/controlpanel.php",
        "/admincp/index.asp",
        "/admincp/login.asp",
        "/admincp/index.html",
        "/adminpanel.html",
        "/webadmin.html",
        "/webadmin/index.html",
        "/webadmin/admin.html",
        "/webadmin/login.html",
        "/admin/admin_login.html",
        "/admin_login.html",
        "/panel-administracion/login.html",
        "/administrator/index.php",
        "/administrator/login.php",
        "/nsw/admin/login.php",
        "/webadmin/login.php",
        "/admin/admin_login.php",
        "/admin_login.php",
        "/administrator/account.php",
        "/administrator.php",
        "/admin_area/admin.html",
        "/pages/admin/",
        "/pages/admin/admin-login.php",
        "/admin/admin-login.php",
        "/admin-login.php",
        "/members/",
        "/bb-admin/index.html",
        "/bb-admin/login.html",
        "/acceso.php",
        "/bb-admin/admin.html",
        "/admin/home.html",
        "/modelsearch/login.php",
        "/moderator.php",
        "/moderator/login.php",
        "/moderator/admin.php",
        "/account.php",
        "/pages/admin/admin-login.html",
        "/admin/admin-login.html",
        "/admin-login.html",
        "/controlpanel.php",
        "/admincontrol.php",
        "/admin/adminLogin.html",
        "/adminLogin.html",
        "/home.html",
        "/rcjakar/admin/login.php",
        "/adminarea/index.html",
        "/adminarea/admin.html",
        "/webadmin.php",
        "/webadmin/index.php",
        "/webadmin/admin.php",
        "/admin/controlpanel.html",
        "/admin.html",
        "/admin/cp.html",
        "/cp.html",
        "/adminpanel.php",
        "/moderator.html",
        "/administrator/index.html",
        "/administrator/login.html",
        "/user.html",
        "/administrator/account.html",
        "/administrator.html",
        "/modelsearch/login.html",
        "/moderator/login.html",
        "/adminarea/login.html",
        "/panel-administracion/index.html",
        "/panel-administracion/admin.html",
        "/modelsearch/index.html",
        "/modelsearch/admin.html",
        "/admincontrol/login.html",
        "/adm/index.html",
        "/adm.html",
        "/moderator/admin.html",
        "/user.php",
        "/account.html",
        "/controlpanel.html",
        "/admincontrol.html",
        "/panel-administracion/login.php",
        "/wp-login.php",
        "/adminLogin.php",
        "/admin/adminLogin.php",
        "/home.php",
        "/adminarea/index.php",
        "/adminarea/admin.php",
        "/adminarea/login.php",
        "/panel-administracion/index.php",
        "/panel-administracion/admin.php",
        "/modelsearch/index.php",
        "/modelsearch/admin.php",
        "/admincontrol/login.php",
        "/adm/admloginuser.php",
        "/admloginuser.php",
        "/admin2.php",
        "/admin2/login.php",
        "/admin2/index.php",
        "/usuarios/login.php",
        "/adm/index.php",
        "/adm.php",
        "/affiliate.php",
        "/adm_auth.php",
        "/memberadmin.php",
        "/administratorlogin.php",
        "admin.",
        "login.",
        "login1.",
        "panel.",
        "admin1.",
        "admin2.",
        "admin3.",
        "admin4.",
        "moderator.",
        "webadmin.",
        "user.",
        "/administration/",
        "/mag/admin/",
        "/joomla/administrator/",
        "/manager/",
        "/adminpanel/",
        "/controlpanel/",
        "/logon/",
        "/auth/",
        "/apanel/",
        "/a/",
        "/acart/",
        "/access/",
        "/account/",
        "/achievo/",
        "/address/",
        "/admins/",
        "/0admin/",
        "/admin1/",
        "/admin2/",
        "/admin3/",
        "/admin4/",
        "/admin5/",
        "/_adm_/",
        "/_admin_/",
        "/_administrator_/",
        "/_adm/",
        "/_admin/",
        "/achtung/",
        "/_administrator/",
        "/AdminWeb/",
        "/administration.php",
        "/links/login.php",
        "/cms/_admin/logon.php",
        "/typo3/",
        "/pma/",
        "/cms/login/",
        "/access.php",
        "/sysadm.php",
        "/adm2/",
        "/include/admin.php",
        "/admin/moderator.php",
        "/interactive/admin.php",
        "/edit.php",
        "/siteadmin/",
        "/hcaadmin.php",
        "/svn/",
        "/blog/wp-login.php",
        "/admin/log.php",
        "/login/login.php",
        "/adminka.php",
        "/wholesale-login.php",
        "/authorize.php",
        "/editor/",
        "/base/admin/",
        "/includes/login.php",
        "/site_admin/login.php",
        "/statredir/",
        "/lists/admin/",
        "/sec/login.php",
        "/bitrix/admin/",
        "/admin_tool/",
        "/cabinet/",
        "/klarnetCMS/",
        "/debug/rus/autorisation/",
        "/cms/admin/",
        "/Admin/private/",
        "/site/admin/",
        "/admen/",
        "/admin2/index/",
        "/db/admin.php",
        "/admin/adm.php",
        "/admin/admin/",
        "/manager/ispmgr/",
        "/phpMyAdmin/",
        "/login.aspx/",
        "/admin/login.asp",
        "/admin/login.aspx/",
        "/moderator/admin.asp/",
        "/webadmin.asp/",
        "/webadmin/admin.asp/",
        "/author/Admin.aspx/",
        "/admin/userAdmin.aspx/",
        "/dbadmin/",
        "/AdministratorS/Admin.aspx/",
        "/admin/secure/admin.aspx/",
        "/bb-admin/admin.asp/",
        "/processlogin.php/",
        "/0manager/",
        "/acceso.asp/",
        "/acceso.aspx/",
        "/account.asp/",
        "/account.aspx/",
        "/wp-login.asp/",
        "/wp-login.aspx/",
        "/admin_login/",
        "/admin-login/",
        "/modelsearch/",
        "/nsw/",
        "/rcjakar/",
        "/private.php/",
        "/_vti_pvt/",
        "/_private/",
        "/admin1.php",
        "/admin2.html",
        "/yonetim.php",
        "/yonetim.html",
        "/nedmin/production/login.php",
        "/nedmin/production/index.php",
        "/yonetici.php",
        "/yonetici.html",
        "/admin1.asp",
        "/admin2.asp",
        "/yonetim.asp",
        "/yonetici.asp",
        "/admin/index.asp",
        "/admin/home.asp",
        "/admin/controlpanel.asp",
        "/sysadmin.php",
        "/sysadmin.html",
        "/sysadmin/",
        "/ur-admin.asp",
        "/ur-admin.php",
        "/ur-admin.html",
        "/ur-admin/",
        "/administr8.php",
        "/administr8.html",
        "/administr8/",
        "/admin/acceso.php/",
        "/admin/acceso.asp/",
        "/admin/acceso.aspx/",
        "/admin_area/acceso.php/",
        "/admin_area/acceso.asp/",
        "/admin_area/acceso.aspx/",
        "/adminarea/acceso.php/",
        "/adminarea/acceso.asp/",
        "/adminarea/acceso.aspx/",
        "/admincontrol/acceso.php/",
        "/admincontrol/acceso.asp/",
        "/admincontrol/acceso.aspx/",
        "/admincpacceso.php/",
        "/admincpacceso.asp/",
        "/admincpacceso.aspx/",
        "/administrator/acceso.php/",
        "/administrator/acceso.asp/",
        "/administrator/acceso.aspx/",
        "/admin_login/acceso.php/",
        "/admin_login/acceso.asp/",
        "/admin_login/acceso.aspx/",
        "/adminlogin/acceso.php/",
        "/adminlogin/acceso.asp/",
        "/adminlogin/acceso.aspx/",
        "/webadmin/wp-login.php/",
        "/webadmin/wp-login.asp/",
        "/webadmin/wp-login.aspx/",
        "/usuario/wp-login.php/",
        "/usuario/wp-login.asp/",
        "/usuario/wp-login.aspx/",
        "/admin/webadmin.asp/",
        "/admin/webadmin.aspx/",
        "/admin/webadmin.php/",
        "/webadmin/user.php/",
        "/webadmin/user.asp/",
        "/webadmin/user.aspx/",
        "/bb-admin/user.php",
        "/bb-admin/user.asp",
        "/bb-admin/user.aspx",
        "/controlpanel/user.php",
        "/controlpanel/user.asp",
        "/controlpanel/user.aspx",
        "/admin-login/user.php",
        "/admin-login/user.asp",
        "/admin-login/user.aspx",
        "/administrator/user.php",
        "/administrator/user.asp",
        "/administrator/user.aspx",
        "/admin/user.php",
        "/adm/user.php",
        "/pages/moderator.php",
        "/webadmin/moderator.php",
        "/users/moderator.php",
        "/usuario/user.php/",
        "/usuario/user.asp/",
        "/usuario/user.aspx/",
        "/mysql/",
        "/myadmin/",
        "/sqlmanager/",
        "/mysqlmanager/",
        "/p/m/a/",
        "/phpmanager/",
        "/php-myadmin/",
        "/phpmy-admin/",
        "/sqlweb/",
        "/websql/",
        "/webdb/",
        "/mysqladmin/",
        "/mysql-admin/",
        "/phpmyadmin2/",
        "/phpMyAdmin-2/",
        "/php-my-admin/",
        "/phpMyAdmin-2.2.3/",
        "/phpMyAdmin-2.2.6/",
        "/phpMyAdmin-2.5.1/",
        "/phpMyAdmin-2.5.4/",
        "/phpMyAdmin-2.5.5-rc1/",
        "/phpMyAdmin-2.5.5-rc2/",
        "/phpMyAdmin-2.5.5/",
        "/phpMyAdmin-2.5.5-pl1/",
        "/phpMyAdmin-2.5.6-rc1/",
        "/phpMyAdmin-2.5.6-rc2/",
        "/phpMyAdmin-2.5.6/",
        "/phpMyAdmin-2.5.7/",
        "/phpMyAdmin-2.5.7-pl1/",
        "/phpMyAdmin-2.6.0-alpha/",
        "/phpMyAdmin-2.6.0-alpha2/",
        "/phpMyAdmin-2.6.0-beta1/",
        "/phpMyAdmin-2.6.0-beta2/",
        "/phpMyAdmin-2.6.0-rc1/",
        "/phpMyAdmin-2.6.0-rc2/",
        "/phpMyAdmin-2.6.0-rc3/",
        "/phpMyAdmin-2.6.0/",
        "/phpMyAdmin-2.6.0-pl1/",
        "/phpMyAdmin-2.6.0-pl2/",
        "/phpMyAdmin-2.6.0-pl3/",
        "/phpMyAdmin-2.6.1-rc1/",
        "/phpMyAdmin-2.6.1-rc2/",
        "/phpMyAdmin-2.6.1/",
        "/phpMyAdmin-2.6.1-pl1/",
        "/phpMyAdmin-2.6.1-pl2/",
        "/phpMyAdmin-2.6.1-pl3/",
        "/phpMyAdmin-2.6.2-rc1/",
        "/phpMyAdmin-2.6.2-beta1/",
        "/phpMyAdmin-2.6.2/",
        "/phpMyAdmin-2.6.2-pl1/",
        "/phpMyAdmin-2.6.3/",
        "/phpMyAdmin-2.6.3-rc1/",
        "/phpMyAdmin-2.6.3-pl1/",
        "/phpMyAdmin-2.6.4-rc1/",
        "/phpMyAdmin-2.6.4-pl1/",
        "/phpMyAdmin-2.6.4-pl2/",
        "/phpMyAdmin-2.6.4-pl3/",
        "/phpMyAdmin-2.6.4-pl4/",
        "/phpMyAdmin-2.6.4/",
        "/phpMyAdmin-2.7.0-beta1/",
        "/phpMyAdmin-2.7.0-rc1/",
        "/phpMyAdmin-2.7.0-pl1/",
        "/phpMyAdmin-2.7.0-pl2/",
        "/phpMyAdmin-2.7.0/",
        "/phpMyAdmin-2.8.0-beta1/",
        "/phpMyAdmin-2.8.0-rc2/",
        "/phpMyAdmin-2.8.0/",
        "/phpMyAdmin-2.8.0.1/",
        "/phpMyAdmin-2.8.0.2/",
        "/phpMyAdmin-2.8.0.3/",
        "/phpMyAdmin-2.8.0.4/",
        "/phpMyAdmin-2.8.1-rc1/",
        "/phpMyAdmin-2.8.1/",
        "/phpMyAdmin-2.8.2/",
        "/pma2005/",
        "/administratie/",
        "/admins.php",
        "/useradmin/",
        "/sysadmins/",
        "/system-administration/",
        "/administrators/",
        "/pgadmin/",
        "/directadmin/",
        "/sql-admin/",
        "/newsadmin/",
        "/adminpro/",
        "/staradmin/",
        "/ServerAdministrator/",
        "/SysAdmin/",
        "/administer/",
        "/LiveUser_Admin/",
        "/sys-admin/",
        "/autologin/",
        "/support_login/",
        "/memlogin/",
        "/login-redirect/",
        "/sub-login/",
        "/login1/",
        "/dir-login/",
        "/login_db/",
        "/xlogin/",
        "/smblogin/",
        "/customer_login/",
        "/UserLogin/",
        "/acct_login/",
        "/bigadmin/",
        "/project-admins/",
        "/phppgadmin/",
        "/pureadmin/",
        "/bbadmin/",
        "/administratoraccounts/",
        "/AdminTools/",
        "/server/",
        "/database_administration/",
        "/power_user/",
        "/system_administration/",
        "/adminitem/",
        "/sysadm/",
        "/control/",
        "/accounts/",
        "/management/",
        "/phpSQLiteAdmin/",
        "/showlogin/",
        "/0admin/login.asp",
        "/0manager/admin.asp",
        "/admin/sendfile.asp",
        "/admin/sndfile.asp",
        "/admin/upfile.asp",
        "/admin/upload.asp",
        "/admin/uploadfaceok.asp",
        "/admin/uploads.asp",
        "/admin/uppic.asp",
        "/adminadmin/",
        "/adminindex/",
        "/count_admin",
        "/default_admin",
        "/index/admin",
        "/acesso/",
        "/adimin/",
        "/adiministrador/",
        "/adm/admin/",
        "/admin4_account/",
        "/admin4_colon/",
        "/admin/adm/",
        "/administracao/",
        "/banneradmin/",
        "/blogindex/",
        "/cadmins/",
        "/ccp14admin/",
        "/cmsadmin/",
        "/config/",
        "/controle/",
        "/cpanel_file/",
        "/donos/",
        "/edit/",
        "/entrar",
        "/entrar.html",
        "/entrar.php",
        "/ezsqliteadmin/",
        "/formslogin/",
        "/funcoes/",
        "/globes_admin/",
        "/hpwebjetadmin/",
        "/Indy_admin/",
        "/irc-macadmin/",
        "/key/",
        "/logar/",
        "/login/",
        "/loginflat/",
        "/login-us/",
        "/loginuser/",
        "/loginusuarios/",
        "/logo_sysadmin/",
        "/logout/",
        "/Lotus_Domino_Admin/",
        "/macadmin/",
        "/manuallogin/",
        "/membros/",
        "/meta_login/",
        "/navSiteAdmin/",
        "/net/",
        "/not/",
        "/openvpnadmin/",
        "/painel/",
        "/paineldecontrole/",
        "/pc/",
        "/pdc/",
        "/php/",
        "/phpldapadmin/",
        "/platz_login/",
        "/radmind/",
        "/radmind-1/",
        "/rcLogin/",
        "/saff/",
        "/senha/",
        "/senhas/",
        "/server_admin_small/",
        "/sff/",
        "/simpleLogin/",
        "/sistema/",
        "/sshadmin/",
        "/ss_vms_admin_sm/",
        "/Super-Admin/",
        "/SysAdmin2/",
        "/userlogin/",
        "/utility_login/",
        "/vadmind/",
        "/vmailadmin/",
        "/wizmysqladmin/",
        "/ccms/",
        "/ccms/login.php",
        "/ccms/index.php",
        "/media",
        "/api/v1/nodes",
    ]
    file1 = open(file_path, "r")
    Lines = file1.readlines()
    protocols = ["https://"]
    for protocolType in protocols:
        for endpoint in endpoints:
            for line in Lines:
                line = line.strip()
                full_url = protocolType + line + endpoint
                try:
                    req = requests.get(full_url, timeout=5, verify=False)
                    if req.status_code == 200:
                        rep.append(full_url)
                        print(full_url)
                    else:
                        continue
                except requests.exceptions.ConnectionError:
                    # The website isn't responding, could be a multitude of reasons, ranging from the website
                    # being under VPN to it just plainly not responding to GET requests
                    continue
                    # print("not responding: ", full_url)
                except requests.exceptions.InvalidURL:
                    continue
                    # print("not responding: ", full_url)
                except Exception as e:
                    # Any exception apart from ConnectionError will be handled
                    continue
                    # print("exception", e)
    print(rep)


if __name__ == "__main__":
    # Create the parser
    parser = argparse.ArgumentParser(description="Path of domain file")
    # Add the arguments
    parser.add_argument(
        "-p", "--path", type=str, required=True, help="Path of domain file"
    )
    args = parser.parse_args()
    file_path = args.path
    subdomain_finder(file_path)
    domains = "domains.txt"
    port_scan(domains)
    endpoint_check(domains)
